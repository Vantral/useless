Применение{применение}сверточных{сверточный?}нейронных{нейронный}сетей{сеть}для{для}задач{задача}NLP{NLP??}Когда{когда}мы{мы}слышим{слышать|слышимый}о{о}сверточных{сверточный?}нейронных{нейронный}сетях{сеть}CNN{CNN??}мы{мы}обычно{обычно|обычный}думаем{думать}о{о}компьютерном{компьютерный}зрении{зрение}CNN{CNN??}лежали{лежать}в{в}основе{основа}прорывов{прорыв}в{в}классификации{классификация}изображений{изображение}знаменитый{знаменитый}AlexNet{AlexNet??}победитель{победитель}соревнования{соревнование}ImageNet{ImageNet??}в{в}году{год}с{с}которого{который}начался{начинаться}бум{бум}интереса{интерес}к{к}этой{этот|эта}теме{тема}С{с}тех{тот|тех}пор{пора}сверточные{сверточный?}сети{сеть}достигли{достигать}большого{большой}успеха{успех}в{в}распознавании{распознавание}изображений{изображение}в{в}силу{сила|сило}того{то|тот|того}факта{факт}что{что}они{они}устроены{устраивать}наподобие{наподобие}зрительной{зрительный}коры{кора}головного{головной}мозга{мозг}то{то|тот}есть{быть|есть}умеют{уметь}концентрироваться{концентрироваться}на{на}небольшой{небольшой}области{область}и{и}выделять{выделять}в{в}ней{она|нея}важные{важный}особенности{особенность}Но{но}как{как}оказалось{оказываться}CNN{CNN??}хороши{хороший}не{не}только{только}для{для}этого{это|этот}но{но}и{и}для{для}задач{задача}обработки{обработка}естественного{естественный}языка{язык}Natural{Natural??}Language{Language??}Processing{Processing??}NLP{NLP??}Более{более|много}того{то|тот|того}в{в}недавно{недавно}вышедшей{выходить}статье{статья}от{от}коллектива{коллектив}авторов{автор}из{из|иза}Intel{Intel??}и{и}Carnegie{Carnegie??}Mellon{Mellon??}University{University??}утверждается{утверждаться}что{что}они{они}подходят{подходить}для{для}этого{это|этот}даже{даже}лучше{хорошо|хороший}RNN{RNN??}которые{который}безраздельно{безраздельно|безраздельный}властвовали{властвовать}областью{область}на{на}протяжении{протяжение}последних{последний}лет{год|лет|лета}Сверточные{сверточный?}нейронные{нейронный}сети{сеть}Для{для}начала{начало|начинать}немного{немного|немногий}теории{теория}Что{что}такое{такой}свертка{сверток|свертка}Мы{мы}не{не}будем{быть}на{на}этом{это|этот}останавливаться{останавливаться}подробно{подробно|подробный}так{так}как{как}про{про}это{это|этот}написана{написать}уже{уже|узкий|узко|уж}тонна{тонна|тонный}материалов{материал}но{но}все-таки{все-таки}кратко{кратко|краткий}пробежаться{пробежаться}стоит{стоять|стоить}Есть{быть|есть}красивая{красивый}визуализация{визуализация}от{от}Стэнфорда{стэнфорд?}которая{который}позволяет{позволять}ухватить{ухватывать}суть{суть|быть}Надо{надо}ввести{вводить}базовые{базовый}понятия{понятие}чтобы{чтобы}потом{потом|пот}мы{мы}понимали{понимать}друг{друг}друга{друг}Окошко{окошко}которое{который}ходит{ходить}по{по}большой{большой}матрице{матрица}называется{называться}фильтром{фильтр}в{в}англоязычном{англоязычный}варианте{вариант|варианта}kernel{kernel??}filter{filter??}или{или}feature{feature??}detector{detector??}так{так}что{что}можно{можно}встретить{встречать}переводы{перевод}и{и}кальки{калька}этих{этот}терминов{термин}не{не}пугайтесь{пугаться}это{это|этот}все{весь|все}одно{один}и{и}то{то|тот}же{же}Фильтр{фильтр}накладывается{накладываться}на{на}участок{участок}большой{большой}матрицы{матрица}и{и}каждое{каждый}значение{значение}перемножается{перемножаться}с{с}соответствующим{соответствующий|соответствовать}ему{он|оно}значением{значение}фильтра{фильтр}красные{красный|красное}цифры{цифра}ниже{низко|низкий|ниже}и{и}правее{правее|правый}черных{черный|черные|черных|черная}цифр{цифра}основной{основной|основный}матрицы{матрица}Потом{потом|пот}все{весь|все}получившееся{получаться}складывается{складываться}и{и}получается{получаться}выходное{выходной}отфильтрованное{отфильтровывать}значение{значение}Окно{окно}ходит{ходить}по{по}большой{большой}матрице{матрица}с{с}каким-то{какой-то}шагом{шаг|шагом}который{который}по-английски{по-английски}называется{называться}stride{stride??}Этот{этот}шаг{шаг}бывает{бывать}горизонтальный{горизонтальный}и{и}вертикальный{вертикальный}хотя{хотя|хотеть}последний{последний}нам{мы}не{не}пригодится{пригождаться}Еще{еще}осталось{оставаться}ввести{вводить}важный{важный}концепт{концепт}канала{канал}Каналами{канал}в{в}изображениях{изображение}называются{называться}известные{известный}многим{многий|многое|многие}базовые{базовый}цвета{цвет|цвета}например{например}если{если}мы{мы}говорим{говорить}о{о}простой{простой|простаивать}и{и}распространенной{распространять|распространенный}схеме{схема}цветового{цветовой}кодирования{кодирование}RGB{RGB??}Red{Red??}красный{красный}Green{Green??}зеленый{зеленый}Blue{Blue??}голубой{голубой|голуба}то{то|тот}там{там}предполагается{предполагаться}что{что}из{из|иза}трех{три}этих{этот}базовых{базовый}цветов{цветок|цвет}путем{путем|путь}их{они|их}смешения{смешение}мы{мы}можем{мочь}получить{получать}любой{любой|люба|любая}цвет{цвет|цвета}Ключевое{ключевой}слово{слово}здесь{здесь}смешение{смешение}все{весь|все}три{три|тереть}базовых{базовый}цвета{цвет|цвета}существуют{существовать}одновременно{одновременно|одновременный}и{и}могут{мочь}быть{быть}получены{получать}из{из|иза}например{например}белого{белый}света{свет|света}солнца{солнце}с{с}помощью{помощь}фильтра{фильтр}нужного{нужный}цвета{цвет|цвета}чувствуете{чувствовать}терминология{терминология}начинает{начинать}обретать{обретать}смысл{смысл}И{и}вот{вот}получается{получаться}что{что}у{у}нас{мы}есть{быть|есть}изображение{изображение}в{в}нем{он|оно|немой|нема}есть{быть|есть}каналы{канал}и{и}по{по}нему{он|оно|нема}с{с}нужным{нужный}шагом{шаг|шагом}ходит{ходить}наш{наш}фильтр{фильтр}Осталось{оставаться}понять{понимать}что{что}собственно{собственно|собственный}делать{делать}с{с}этими{этот}каналами{канал}С{с}этими{этот}каналами{канал}мы{мы}делаем{делать}с{с}следующее{следующий|следовать}каждый{каждый}фильтр{фильтр}то{то|тот}есть{быть|есть}матрица{матрица}небольшого{небольшой}размера{размер}накладывается{накладываться}на{на}исходную{исходный}матрицу{матрица}одновременно{одновременно|одновременный}на{на}все{весь|все}три{три|тереть}канала{канал}Результаты{результат}же{же}просто{просто|простой}суммируются{суммироваться}что{что}логично{логично|логичный}если{если}разобраться{разбираться}в{в}конце{конец}концов{конец}каналы{канал}это{это|этот}наш{наш}способ{способ}работать{работать}с{с}непрерывным{непрерывный}физическим{физический}спектром{спектр}света{свет|света}Нужно{нужно|нужный}упомянуть{упоминать}еще{еще}одну{один}деталь{деталь}без{без}которой{который}понимание{понимание}дальнейшего{дальнейший}будет{будет|быть}затруднено{затруднять}открою{открывать|откраивать}вам{вы}страшную{страшный}тайну{тайна}фильтров{фильтр|фильтровый}в{в}сверточных{сверточный?}сетях{сеть}гораздо{гораздо|горазд}больше{больше|большой|много|больший}Что{что}значит{значит|значить}гораздо{гораздо|горазд}больше{больше|большой|много|больший}Это{это|этот}значит{значит|значить}что{что}у{у}нас{мы}существует{существовать}n{n??}фильтров{фильтр|фильтровый}выполняющих{выполнять}одну{один}и{и}ту{тот}же{же}работу{работа}Они{они}ходят{ходить}с{с}окном{окно}по{по}матрице{матрица}и{и}что-то{что-то}рассматривают{рассматривать}Казалось{казаться|казалось}бы{бы}зачем{зачем}делать{делать}одну{один}работу{работа}два{два}раза{раз}Одну{один}да{да}не{не}одну{один}из-за{из-за}различной{различный}инициализации{инициализация}фильтрующих{фильтровать}матриц{матрица}в{в}процессе{процесс}обучения{обучение}они{они}начинают{начинать}обращать{обращать}внимание{внимание}на{на}разные{разный}детали{деталь}К{к}примеру{пример}один{один}фильтр{фильтр}смотрит{смотреть}на{на}линии{линия}а{а}другой{другой}на{на}определенный{определенный|определять}цвет{цвет|цвета}Это{это|этот}визуализация{визуализация}разных{разный}фильтров{фильтр|фильтровый}одного{один}слоя{слой|слоить}одной{один}сети{сеть}Видите{видеть}что{что}они{они}смотрят{смотреть}на{на}совершенно{совершенно|совершенный}разные{разный}особенности{особенность}изображения{изображение}Все{весь|все}мы{мы}вооружены{вооруженный|вооружать}терминологией{терминология}для{для}того{то|тот|того}чтобы{чтобы}двигаться{двигаться}дальше{далеко|далекий}Параллельно{параллельно|параллельный}с{с}терминологией{терминология}мы{мы}разобрались{разбираться}как{как}работает{работать}сверточный{сверточный?}слой{слой}Он{он}является{являться}базовым{базовый}для{для}сверточных{сверточный?}нейронных{нейронный}сетей{сеть}Есть{быть|есть}еще{еще}один{один}базовый{базовый}слой{слой}для{для}CNN{CNN??}это{это|этот}так{так}называемый{называть}pooling{pooling??}слой{слой}Проще{простой|просто}всего{все|всего|весь}его{он|оно|его}объяснить{объяснять}на{на}примере{пример}max{max??}pooling{pooling??}Итак{итак}представьте{представлять}что{что}в{в}уже{уже|узкий|узко|уж}известном{известный}вам{вы}сверточном{сверточный?}слое{слой}матрица{матрица}фильтра{фильтр}зафиксирована{зафиксировать}и{и}является{являться}единичной{единичный}то{то|тот}есть{быть|есть}умножение{умножение}на{на}нее{она|нея}никак{никак}не{не}влияет{влиять}на{на}входные{входной}данные{данные|давать|данный}А{а}еще{еще}вместо{вместо}суммирования{суммирование}всех{весь|все}результатов{результат}умножения{умножение}входных{входной}данных{данные|давать|данный}по{по}нашему{наш}условию{условие}мы{мы}выбираем{выбирать}просто{просто|простой}максимальный{максимальный}элемент{элемент}То{то|тот}есть{быть|есть}мы{мы}выберем{выбирать}из{из|иза}всего{все|всего|весь}окна{окно}пиксель{пиксел}с{с}наибольшей{большой}интенсивностью{интенсивность}Это{это|этот}и{и}есть{быть|есть}max{max??}pooling{pooling??}Конечно{конечно|конечный}вместо{вместо}функций{функция}максимум{максимум}может{мочь|может}быть{быть}другая{другой}арифметическая{арифметический}или{или}даже{даже}более{более|много}сложная{сложный}функция{функция}В{в}качестве{качество}дальнейшего{дальнейший}чтения{чтение}по{по}этому{этот|это}поводу{повод}я{я}рекомендую{рекомендовать}пост{пост}Криса{крис}Ола{ола}Chris{Chris??}Olah{Olah??}Все{весь|все}вышеназванное{вышеназванный}это{это|этот}хорошо{хорошо|хороший}но{но}без{без}нелинейности{нелинейность}у{у}нейронных{нейронный}сетей{сеть}не{не}будет{будет|быть}так{так}необходимого{необходимый}нам{мы}свойства{свойство}универсального{универсальный}аппроксиматора{аппроксиматор?}Соответственно{соответственно|соответственный}надо{надо}сказать{сказать}пару{пара|пар}слов{слово}про{про}них{они}В{в}рекуррентных{рекуррентный}и{и}полносвязных{полносвязный?|полносвязной?}сетях{сеть}бал{бал}правят{править}такие{такой}нелинейности{нелинейность}как{как}сигмоида{сигмоид?}и{и}гиперболический{гиперболический}тангенс{тангенс}Это{это|этот}хорошие{хороший}нелинейные{нелинейный}гладкие{гладкий}функции{функция}но{но}они{они}все-таки{все-таки}требуют{требовать}существенных{существенный}вычислений{вычисление}по{по}сравнению{сравнение}с{с}той{тот|той}которая{который}правил{правило|править}бал{бал}в{в}CNN{CNN??}ReLU{ReLU??}Rectified{Rectified??}Linear{Linear??}Unit{Unit??}По-русски{по-русски}ReLU{ReLU??}принято{принимать|принятый}называть{называть}линейным{линейный}фильтром{фильтр}вы{вы}еще{еще}не{не}устали{уставать|усталь}от{от}использования{использование}слова{слово}фильтр{фильтр}Это{это|этот}простейшая{простой}нелинейная{нелинейный}функция{функция}к{к}тому{то|тот|тома|том}же{же}не{не}гладкая{гладкий}Но{но}зато{зато}она{она}вычисляется{вычисляться}за{за}одну{один}элементарную{элементарный}операцию{операция}за{за}что{что}ее{она|ее}очень{очень}любят{любить}разработчики{разработчик}вычислительных{вычислительный}фреймворков{фреймворков?|фреймворок?|фреймворк?}Ладно{ладно|ладный}мы{мы}с{с}вами{вы}уже{уже|узкий|узко|уж}обсудили{обсуждать}сверточные{сверточный?}нейронные{нейронный}сети{сеть}как{как}устроено{устраивать}зрение{зрение}и{и}всякое{всякий|всякое}такое{такой}Но{но}где{где}же{же}про{про}тексты{текст}или{или}я{я}вас{вы}бессовестно{бессовестный}обманывал{обманывать}Нет{нет}я{я}вас{вы}не{не}обманывал{обманывать}Применение{применение}сверток{сверток|свертка}к{к}текстам{текст}Вот{вот}эта{этот|эта}картинка{картинка}практически{практически|практический}полностью{полностью}объясняет{объяснять}как{как}мы{мы}работает{работать}с{с}текстом{текст}с{с}помощью{помощь}CNN{CNN??}Непонятно{непонятно|непонятный}Давайте{давать}разбираться{разбираться}Прежде{прежде}всего{все|всего|весь}вопрос{вопрос}откуда{откуда}у{у}нас{мы}возьмется{взяться}матрица{матрица}для{для}работы{работа}CNN{CNN??}же{же}работают{работать}с{с}матрицами{матрица}не{не}так{так}ли{ли}Здесь{здесь}нам{мы}нужно{нужно|нужный}вернуться{вернуться}немного{немного|немногий}назад{назад}и{и}вспомнить{вспомнить}что{что}такое{такой}embedding{embedding??}по{по}этому{этот|это}поводу{повод}есть{быть|есть}отдельная{отдельный}статья{статья}Если{если}вкратце{вкратце}embedding{embedding??}это{это|этот}сопоставление{сопоставление}точки{точка}в{в}каком-то{какой-то}многомерном{многомерный}пространстве{пространство}объекту{объект}в{в}нашем{наш}случае{случай}слову{слово}Примером{пример}возможно{возможно|возможный}самым{самый}известным{известный}такого{такой}embedding{embedding??}является{являться}У{у}него{он|оно}кстати{кстати}есть{быть|есть}семантические{семантический}свойства{свойство}вроде{вроде}king{king??}man{man??}woman{woman??}queen{queen??}Так{так}вот{вот}мы{мы}берем{брать}embedding{embedding??}для{для}каждого{каждый}слова{слово}в{в}нашем{наш}тексте{текст}и{и}просто{просто|простой}ставим{ставить}все{весь|все}вектора{вектор}в{в}ряд{ряд}получая{получать}искомую{искомый}матрицу{матрица}Теперь{теперь}следующий{следующий|следовать}шаг{шаг}матрица{матрица}это{это|этот}хорошо{хорошо|хороший}и{и}она{она}вроде{вроде}бы{бы}даже{даже}похожа{похожий}на{на}картинку{картинка}те{тот}же{же}два{два}измерения{измерение}Или{или}нет{нет}Подождите{подождать}у{у}нас{мы}в{в}картинке{картинка}есть{быть|есть}еще{еще}каналы{канал}Получается{получаться}что{что}в{в}матрице{матрица}картинки{картинка}у{у}нас{мы}три{три|тереть}измерения{измерение}ширина{ширина|ширин}высота{высота}и{и}каналы{канал}А{а}здесь{здесь}А{а}здесь{здесь}у{у}нас{мы}есть{быть|есть}только{только}ширина{ширина|ширин}на{на}заглавной{заглавный}картинке{картинка}раздела{раздел|раздевать}матрица{матрица}для{для}удобства{удобство}отображения{отображение}транспонирована{транспонировать}это{это|этот}последовательность{последовательность}токенов{токен?|токеновый?}в{в}предложении{предложение}И{и}нет{нет}не{не}высота{высота}а{а}каналы{канал}Почему{почему}каналы{канал}Потому{потому}что{что}embedding{embedding??}слова{слово}имеет{иметь}смысл{смысл}только{только}полностью{полностью}каждое{каждый}отдельное{отдельный}его{он|оно|его}измерение{измерение}нам{мы}ни{ни}о{о}чем{чем|что}не{не}скажет{сказать}Хорошо{хорошо|хороший}разобрались{разбираться}с{с}матрицей{матрица}теперь{теперь}дальше{далеко|далекий}про{про}свертки{сверток|свертка}Получается{получаться}что{что}свертка{сверток|свертка}у{у}нас{мы}может{мочь|может}ходить{ходить}только{только}по{по}одной{один}оси{ось|ося}по{по}ширине{ширина|ширин}Поэтому{поэтому}для{для}того{то|тот|того}чтобы{чтобы}отличить{отличать}от{от}стандартной{стандартный}свертки{сверток|свертка}ее{она|ее}называют{называть}одномерной{одномерный}convolution{convolution??}И{и}сейчас{сейчас}уже{уже|узкий|узко|уж}практически{практически|практический}все{весь|все}понятно{понятно|понятный}кроме{кроме}загадочного{загадочный}Max{Max??}Over{Over??}Time{Time??}Pooling{Pooling??}Что{что}это{это|этот}за{за}зверь{зверь}Это{это|этот}уже{уже|узкий|узко|уж}обсуждавшийся{обсуждаться}выше{высоко|высокий|выше|выша}max{max??}pooling{pooling??}только{только}примененный{применять}ко{ко}всей{весь|всевать}последовательности{последовательность}сразу{сразу}то{то|тот}есть{быть|есть}ширина{ширина|ширин}его{он|оно|его}окна{окно}равна{равный}всей{весь|всевать}ширине{ширина|ширин}матрицы{матрица}Примеры{пример}использования{использование}сверточных{сверточный?}нейронных{нейронный}сетей{сеть}для{для}текстов{текст}Картинка{картинка}для{для}привлечения{привлечение}внимания{внимание}На{на}самом{самый|сам}деле{дело}иллюстрация{иллюстрация}из{из|иза}работы{работа}Сверточные{сверточный?}нейронные{нейронный}сети{сеть}хороши{хороший}там{там}где{где}нужно{нужно|нужный}увидеть{увидеть}кусочек{кусочек}или{или}всю{весь}последовательность{последовательность}целиком{целиком|целик}и{и}сделать{сделать}какой-то{какой-то}вывод{вывод}из{из|иза}этого{это|этот}То{то|тот}есть{быть|есть}это{это|этот}задачи{задача}например{например}детекции{детекция?}спама{спам}анализа{анализ}тональности{тональность}или{или}извлечения{извлечение}именованных{именовать|именованный}сущностей{сущность}Разбор{разбор}статей{статья|стать}может{мочь|может}быть{быть}сложен{сложный|слагать|сложенный}для{для}вас{вы}если{если}вы{вы}только{только}что{что}познакомились{познакомиться}с{с}нейронными{нейронный}сетями{сеть}этот{этот}раздел{раздел|раздевать}можно{можно}пропустить{пропустить|пропускать}В{в}работе{работа}Юн{юный|юна}Ким{ким|кима}Yoon{Yoon??}Kim{Kim??}показывает{показывать}что{что}CNN{CNN??}хороши{хороший}для{для}классификации{классификация}предложений{предложение}на{на}разных{разный}датасетах{датасет?}Картинка{картинка}использованная{использовать}для{для}иллюстрации{иллюстрация}раздела{раздел|раздевать}выше{высоко|высокий|выше|выша}как{как}раз{раз}из{из|иза}его{он|оно|его}работы{работа}Он{он}работает{работать}с{с}но{но}можно{можно}и{и}работать{работать}непосредственно{непосредственно|непосредственный}с{с}символами{символ}В{в}работе{работа}авторы{автор}классифицируют{классифицировать}тексты{текст}исходя{исходить}прямо{прямо|прямой}из{из|иза}букв{буква}выучивая{выучивать}embedding{embedding??}для{для}них{они}в{в}процессе{процесс}обучения{обучение}На{на}больших{большой|больший}датасетах{датасет?}они{они}показали{показывать}даже{даже}лучшие{хороший}результаты{результат}чем{чем|что}сети{сеть}работавшие{работать}со{со}словами{слово}У{у}сверточных{сверточный?}нейронных{нейронный}сетей{сеть}есть{быть|есть}существенный{существенный}недостаток{недостаток}по{по}сравнению{сравнение}с{с}RNN{RNN??}они{они}могут{мочь}работать{работать}только{только}со{со}входом{вход}фиксированного{фиксированный|фиксировать}размера{размер}т{т}к{к}размеры{размер}матриц{матрица}в{в}сети{сеть}не{не}могут{мочь}меняться{меняться}в{в}процессе{процесс}работы{работа}Но{но}авторы{автор}вышеупомянутой{вышеупомянутый}работы{работа}смогли{смочь}решить{решать}эту{этот|эта}проблему{проблема}Так{так}что{что}теперь{теперь}и{и}это{это|этот}ограничение{ограничение}снято{снимать|снятой}В{в}работе{работа}авторы{автор}классифицируют{классифицировать}тексты{текст}исходя{исходить}прямо{прямо|прямой}из{из|иза}символов{символ}Они{они}использовали{использовать}набор{набор}из{из|иза}символов{символ}для{для}того{то|тот|того}чтобы{чтобы}представить{представлять}каждый{каждый}символ{символ}как{как}one{one??}hot{hot??}вектор{вектор}и{и}установили{устанавливать}фиксированную{фиксированный|фиксировать}длину{длина}текста{текст}в{в}символа{символ}Таким{такой}образом{образ}текст{текст}представлен{представлять}бинарной{бинарный}матрицей{матрица}размером{размер}Сеть{сеть}не{не}имеет{иметь}представления{представление}о{о}словах{слово}и{и}видит{видеть}их{они|их}как{как}комбинации{комбинация}символов{символ}и{и}информация{информация}о{о}семантической{семантический}близости{близость}слов{слово}не{не}предоставлена{предоставлять}сети{сеть}как{как}в{в}случаях{случай}заранее{заранее}натренированных{натренировать|натренированный}векторов{вектор}Сеть{сеть}состоит{состоять}из{из|иза}conv{conv??}max{max??}pooling{pooling??}слоев{слой}и{и}двух{два}fully{fully??}connected{connected??}слоев{слой}с{с}дропаутом{дропаут?}На{на}больших{большой|больший}датасетах{датасет?}они{они}показали{показывать}даже{даже}лучшие{хороший}результаты{результат}чем{чем|что}сети{сеть}работавшие{работать}со{со}словами{слово}К{к}тому{то|тот|тома|том}же{же}этот{этот}подход{подход}заметно{заметно|заметный}упрощает{упрощать}preprocessing{preprocessing??}шаг{шаг}что{что}может{мочь|может}поспособствовать{поспособствовать}его{он|оно|его}использованию{использование}на{на}мобильных{мобильный}устройствах{устройство}В{в}другой{другой}работе{работа}авторы{автор}пытаются{пытаться}улучшить{улучшать}применение{применение}CNN{CNN??}в{в}NLP{NLP??}использованием{использование}наработок{наработка}из{из|иза}компьютерного{компьютерный}зрения{зрение}Главные{главный|главное}тренды{тренд}в{в}компьютерно{компьютерный}зрении{зрение}в{в}последнее{последний}время{время}это{это|этот}увеличивание{увеличивание?}глубины{глубина}сети{сеть}и{и}добавление{добавление}так{так}называемых{называть}skip{skip??}связей{связь|связи}e{e??}g{g??}ResNet{ResNet??}которые{который}связывают{связывать}слои{слой|слоить}которые{который}не{не}соседствуют{соседствовать}друг{друг}с{с}другом{другой|друг}Авторы{автор}показали{показывать}что{что}те{тот}же{же}принципы{принцип}применимы{применимый}и{и}в{в}NLP{NLP??}они{они}построили{построить}CNN{CNN??}на{на}основе{основа}символов{символ}с{с}размерными{размерный}embedding{embedding??}которое{который}учились{учиться}вместе{вместе}с{с}сетью{сеть}Они{они}натренировали{натренировать}сети{сеть}разной{разный}глубины{глубина}и{и}conv{conv??}слоёв{слой}и{и}поэкспериментировали{поэкспериментировать}со{со}skip{skip??}связями{связь|связи}чтобы{чтобы}выяснить{выяснять|выяснивать}как{как}они{они}влияют{влиять}на{на}результат{результат}Они{они}пришли{приходить|прийти|присылать}к{к}выводу{вывод}что{что}увеличение{увеличение}глубины{глубина}сети{сеть}улучшает{улучшать}результаты{результат}на{на}выбранных{выбирать}датасетах{датасет?}но{но}производительность{производительность}слишком{слишком}глубоких{глубокий}сетей{сеть}слоев{слой}ниже{низко|низкий|ниже}чем{чем|что}умеренно{умеренно|умеренный}глубоких{глубокий}слоев{слой}Применение{применение}skip{skip??}связей{связь|связи}привел{приводить}к{к}улучшению{улучшение}результатов{результат}сети{сеть}из{из|иза}слоев{слой}но{но}все{весь|все}равно{равно|равный}не{не}превзошел{превосходить}показатель{показатель}сети{сеть}с{с}слоями{слой}Другая{другой}важная{важный}особенность{особенность}CNN{CNN??}в{в}компьютерном{компьютерный}зрении{зрение}это{это|этот}возможность{возможность}использования{использование}весов{весы|вес}сети{сеть}натренированной{натренировать|натренированный}на{на}одном{один}большом{большой}датасете{датасет?|датасти?|датасать?}типичный{типичный}пример{пример|примирать|примереть}ImageNet{ImageNet??}в{в}других{другой}задачах{задача}компьютерного{компьютерный}зрения{зрение}В{в}работе{работа}авторы{автор}исследуют{исследовать}применимость{применимость}этих{этот}принципов{принцип}в{в}задаче{задача}классификации{классификация}текстов{текст}с{с}помощью{помощь}CNN{CNN??}с{с}word{word??}embedding{embedding??}Они{они}изучают{изучать}как{как}перенос{перенос}тех{тот|тех}или{или}иных{иной}частей{часть}сети{сеть}Embedding{Embedding??}conv{conv??}слои{слой|слоить}и{и}fully{fully??}connected{connected??}слои{слой|слоить}влияет{влиять}на{на}результаты{результат}классификации{классификация}на{на}выбранных{выбирать}датасетах{датасет?}Они{они}приходят{приходить}к{к}выводу{вывод}что{что}в{в}NLP{NLP??}задачах{задача}семантическая{семантический}близость{близость}источника{источник}на{на}котором{который|котор}заранее{заранее}тренировалась{тренироваться}сеть{сеть}играет{играть}важную{важный}роль{роль|роля}то{то|тот}есть{быть|есть}сеть{сеть}натренированная{натренировать|натренированный}на{на}рецензиях{рецензия}к{к}фильмам{фильм}будет{будет|быть}хорошо{хорошо|хороший}работать{работать}на{на}другом{другой|друг}датасете{датасет?|датасти?|датасать?}с{с}кинорецензиями{кинорецензия?}К{к}тому{то|тот|тома|том}же{же}они{они}отмечают{отмечать}что{что}использование{использование}тех{тот|тех}же{же}embedding{embedding??}для{для}слов{слово}увеличивает{увеличивать}успех{успех}трансфера{трансфер}и{и}рекомендуют{рекомендовать}не{не}замораживать{замораживать}слои{слой|слоить}а{а}дотренировывать{дотренировывать?}их{они|их}на{на}целевом{целевой}датасете{датасет?|датасти?|датасать?}Практический{практический}пример{пример|примирать|примереть}Давайте{давать}на{на}практике{практика|практик}посмотрим{посмотреть}как{как}сделать{сделать}sentiment{sentiment??}analysis{analysis??}на{на}CNN{CNN??}Мы{мы}разбирали{разбирать}похожий{похожий}пример{пример|примирать|примереть}в{в}статье{статья}про{про}Keras{Keras??}поэтому{поэтому}за{за}всеми{весь|все}деталями{деталь}я{я}отсылаю{отсылать}вас{вы}к{к}ней{она|нея}а{а}здесь{здесь}будут{быть}рассмотрены{рассматривать}только{только}ключевые{ключевой}для{для}понимания{понимание}особенности{особенность}Прежде{прежде}всего{все|всего|весь}на{на}понадобится{понадобиться}концепция{концепция}Sequence{Sequence??}из{из|иза}Keras{Keras??}Собственно{собственно|собственный}это{это|этот}и{и}есть{быть|есть}последовательность{последовательность}в{в}удобном{удобный}для{для}Keras{Keras??}виде{вид}Здесь{здесь}text{text??}to{to??}sequences{sequences??}функция{функция}которая{который}переводит{переводить}текст{текст}в{в}последовательность{последовательность}целых{целый|целое}чисел{число}путем{путем|путь}а{а}токенизации{токенизация?}то{то|тот}есть{быть|есть}разбиения{разбиение}строки{строка}на{на}токены{токен?}и{и}б{б}замены{замена}каждого{каждый}токена{токен?}на{на}его{он|оно|его}номер{номер}в{в}словаре{словарь}Словарь{словарь}в{в}этом{это|этот}примере{пример}составлен{составлять}заранее{заранее}Код{код|кода}для{для}его{он|оно|его}составления{составление}в{в}полном{полный}ноутбуке{ноутбук}Далее{далее}получившиеся{получаться}последовательности{последовательность}нужно{нужно|нужный}выровнять{выравнивать}как{как}мы{мы}помним{помнить}CNN{CNN??}пока{пока}не{не}умеют{уметь}работать{работать}с{с}переменной{переменный|переменная}длиной{длина}текста{текст}это{это|этот}пока{пока}не{не}дошло{доходить|дошлый}до{до}промышленного{промышленный}применения{применение}После{после|посол}этого{это|этот}все{весь|все}последовательности{последовательность}будут{быть}либо{либо}обрезаны{обрезать}либо{либо}дополнены{дополнять}нулями{ноль}до{до}длины{длина}max{max??}len{len??}А{а}теперь{теперь}собственно{собственно|собственный}самое{самый|сам}важное{важный}код{код|кода}нашей{наш|нашивать}модели{модель}Первым{первый|первое}слоем{слой}у{у}нас{мы}идет{идти}Embedding{Embedding??}который{который}переводит{переводить}целые{целый|целое}числа{число}на{на}самом{самый|сам}деле{дело}one{one??}hot{hot??}вектора{вектор}в{в}которых{который}место{место}единицы{единица}соответствует{соответствовать}номеру{номер}слова{слово}в{в}словаре{словарь}в{в}плотные{плотный}вектора{вектор}В{в}нашем{наш}примере{пример}размер{размер}embedding{embedding??}пространства{пространство}длина{длина}вектора{вектор}составляет{составлять}количество{количество}слов{слово}в{в}словаре{словарь}max{max??}words{words??}и{и}количество{количество}слов{слово}в{в}последовательности{последовательность}max{max??}len{len??}как{как}мы{мы}уже{уже|узкий|узко|уж}знаем{знать}из{из|иза}кода{код|кода}выше{высоко|высокий|выше|выша}После{после|посол}embedding{embedding??}идет{идти}одномерный{одномерный}сверточный{сверточный?}слой{слой}Количество{количество}фильтров{фильтр|фильтровый}в{в}нем{он|оно|немой|нема}а{а}ширина{ширина|ширин}окна{окно}для{для}фильтров{фильтр|фильтровый}равна{равный}Активация{активация}должна{должный}быть{быть}понятна{понятный}это{это|этот}всеми{весь|все}любимый{любимый|любить}ReLU{ReLU??}После{после|посол}ReLU{ReLU??}идет{идти}слой{слой}Global{Global??}в{в}данном{давать|данный}случае{случай}означает{означать}что{что}он{он}берется{браться}по{по}всей{весь|всевать}длине{длина}входящей{входить|входящая|входящий}последовательности{последовательность}то{то|тот}есть{быть|есть}это{это|этот}ни{ни}что{что}иное{иной}как{как}вышеупомянавшийся{вышеупомянаваться?|вышеупомянаться?}Max{Max??}Over{Over??}Time{Time??}Pooling{Pooling??}Кстати{кстати}почему{почему}он{он}называется{называться}Over{Over??}Time{Time??}Потому{потому}что{что}последовательность{последовательность}слов{слово}у{у}нас{мы}имеет{иметь}естественный{естественный}порядок{порядок}некоторые{некоторый|некоторые}слова{слово}приходят{приходить}к{к}нам{мы}раньше{рано|ранний}в{в}потоке{поток}речи{речь}текста{текст}то{то|тот}есть{быть|есть}раньше{рано|ранний}по{по}времени{время|временить}Вот{вот}какая{какой|какать}модель{модель}у{у}нас{мы}получилась{получаться}в{в}итоге{итог}На{на}картинке{картинка}можно{можно}заметить{замечать}интересную{интересный}особенность{особенность}после{после|посол}сверточного{сверточный?}слоя{слой|слоить}длина{длина}последовательности{последовательность}стала{становиться}вместо{вместо}Почему{почему}так{так}Потому{потому}что{что}мы{мы}с{с}вами{вы}не{не}разговаривали{разговаривать}и{и}не{не}применяли{применять}padding{padding??}технику{техника|техник}позволяющую{позволять}виртуально{виртуальный}добавить{добавлять}данных{данные|давать|данный}в{в}исходную{исходный}матрицу{матрица}чтобы{чтобы}светка{светок|светка|светко}могла{мочь}выйти{выходить}за{за}ее{она|ее}пределы{предел}А{а}без{без}этого{это|этот}свертка{сверток|свертка}длины{длина}с{с}шагом{шаг|шагом}равным{равный}сможет{смочь}сделать{сделать}по{по}матрице{матрица}шириной{ширина}только{только}шагов{шаг}Ладно{ладно|ладный}что{что}же{же}у{у}нас{мы}получилось{получаться}в{в}итоге{итог}На{на}моих{мой}тестах{тесто|тест}этот{этот}классификатор{классификатор}дал{давать}качество{качество}что{что}конечно{конечно|конечный}немного{немного|немногий}Но{но}вы{вы}легко{легко|легкий}сможете{смочь}улучшить{улучшать}мой{мой|мыть}результат{результат}если{если}приложите{прикладывать}немного{немного|немногий}усилий{усилие}Дерзайте{дерзать}
